document.addEventListener('DOMContentLoaded',()=>{const f=document.querySelector('#loginForm');if(!f) return;f.addEventListener('submit',async function(e){e.preventDefault();const em=document.querySelector('#email').value;const pw=document.querySelector('#password').value;try{const r=await fetch(window.API_BASE + '/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ email: em, password: pw })});const d=await r.json();if(!r.ok) throw new Error(d.message || 'Erro no login');localStorage.setItem('lore_token', d.token);localStorage.setItem('lore_user', JSON.stringify(d.user));if(d.user && d.user.role === 'admin') window.location = '/admin/dashboard.html';else window.location = '/cliente/dashboard.html';}catch(err){alert('Erro: ' + err.message);}});});